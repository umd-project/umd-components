const template=document.createElement("template");template.innerHTML='\n    <style>\n      :host {\n        display:grid;\n        grid-template-rows: max-content;\n        grid-template-columns: auto;\n      }\n\n      :host([hidden]) {\n        display:none;\n      }\n\n      [hidden] {\n        display: none !important;\n      }\n\n      .dummy {\n        grid-row: 1;\n        grid-column: 1;\n      }\n\n      .presentation {\n        grid-row: 1;\n        grid-column:1;\n        width:100%;\n      }\n    </style>\n    <iframe class="presentation" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen width="100%"></iframe>\n';export class UmdComponentPresentation extends HTMLElement{static get observedAttributes(){return["data-source","data-url","data-aspect"]}constructor(){super(),this._shadowRoot=this.attachShadow({mode:"open"}),this._shadowRoot.appendChild(template.content.cloneNode(!0));const observer=new IntersectionObserver((entry,observer)=>{this._calibrateWH()});observer.observe(this._shadowRoot.querySelector(".presentation"))}connectedCallback(){this._loadPresentation()}_calibrateWH(){const _presentation=this._shadowRoot.querySelector(".presentation"),w=this.offsetWidth,_aspect=this.getAttribute("data-aspect");let h2w=9/16;if(_aspect){const _aspectarr=_aspect.split(":");if(2==_aspectarr.length){const _aspectW=parseFloat(_aspectarr[0]),_aspectH=parseFloat(_aspectarr[1]);0!=_aspectW&&0!=_aspectH&&(h2w=_aspectH/_aspectW)}}let h=parseInt(w*h2w);_presentation.setAttribute("width",`${w}px`),_presentation.setAttribute("height",`${h}px`)}_loadPresentation(){const _url=this.getAttribute("data-url");_url&&this._loadEmbedPresentation(_url)}_loadEmbedPresentation(url){const _presentation=this._shadowRoot.querySelector(".presentation");_presentation.src=this.parseUrl(url)}parseUrl(url){const _url=new URL(url),_origin=_url.origin.toLowerCase();let _pathname=_url.pathname;const _search=_url.search;switch(_origin){case"https://docs.google.com":return _pathname=_pathname.replace("/pub","/embed"),`${_origin}${_pathname}${_search}`;default:return url}}attributeChangedCallback(name,oldVal,newVal){}disconnectedCallback(){}}window.customElements.define("umd-component-presentation",UmdComponentPresentation);